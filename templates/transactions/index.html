{{define "content"}}

<h3>Transactions</h3>

<a href="/transactions/new">New</a> |
<a href="/transactions/new?type=E">Expense</a> |
<a href="/transactions/new?type=I">Income</a> |

{{range .Templates}}
<a href="/transactions/new?template_id={{.ID}}">{{.Title}}</a> |
{{end}}

<br/>
{{range .Alarms}}
<h3 class="red">{{.}}</h3>
{{end}}
<br/>
<div>
    <table id="transactions" class="list">
        {{ range .T}}
            <tr class="{{if eq $.CurrentDate .Date}}current{{end}}">
                <td width="80px"><a href="/transaction/{{.ID}}">{{.Date}}</a></td>
                <td>{{.AccountFrom.Name}}</td>
                <td class="money {{.AccountFrom.Type}}{{.AccountTo.Type}}">
                  {{money .AmountFrom}}
                  {{if ne .AmountFrom .AmountTo}}/ {{money .AmountTo}}{{end}}
                </td>

                <td>{{.AccountTo.Name}}</td>
                <td>{{.Comment}}</td>
                <td><a href="/transaction/{{.ID}}/delete" onclick="return confirm('Are you sure?')">X</a></td>
            </tr>
        {{ end }}
        <tr>
            <td colspan="6">
                {{ range $i, $v := .TotalPages}}
                    {{if eq $i $.Page }}
                        {{$i}}
                    {{else}}
                        <a href="/transactions?page={{$i}}">{{$i}}</a>
                    {{end}}
                {{ end }}
            </td>
        </tr>
    </table>
</div>

<div class="info">
    <table>
        <tr>
            <td colspan="2">
                <table id="rests" class="list">
                    <tr>
                        <th>Balance</th>
                        <th>Rest</th>
                    </tr>
                    {{ range .Rests.Records}}
                    <tr><td>{{.AccountName}}</td><td class="money">{{money .Amount}}</td></tr>
                    {{ end }}
                    <tr>
                        <th></th>
                        <th class="money">{{money .Rests.Total}}</th>
                    </tr>
                </table>
            </td>
        </tr>

        <tr>
            <td valign="top">
                <table class="list">
                    <tr>
                        <th>{{.CurrentMonth}}</th>
                        <th>Income</th>
                    </tr>
                    {{ range .CurrentIncome.Records}}
                    <tr><td>{{.AccountName}}</td><td class="money">{{money .Amount}}</td></tr>
                    {{ end }}
                    <tr>
                        <th></th>
                        <th class="money">{{money .CurrentIncome.Total}}</th>
                    </tr>
                </table>
            </td>
            <td>
                <table class="list">
                    <tr>
                        <th>{{.CurrentMonth}}</th>
                        <th>Expense</th>
                        <th class="text-center"> %/% </th>
                    </tr>
                    {{ range .CurrentExpense.Records}}
                    <tr>
                        <td>{{.AccountName}}</td>
                        <td class="money">{{money .Amount}}</td>
                        <td class="money">{{format64 .Percent}} / {{format64 .SumPercent}}</td>
                    </tr>
                    {{ end }}
                    <tr>
                        <th></th>
                        <th class="money">{{money .CurrentExpense.Total}}</th>
                        <th></th>
                    </tr>
                </table>
            </td>
        </tr>

        <tr>
            <td valign="top">
                <table class="list">
                    <tr>
                        <th>{{.PreviousMonth}}</th>
                        <th>Income</th>
                    </tr>
                    {{ range .PreviousIncome.Records}}
                    <tr><td>{{.AccountName}}</td><td class="money">{{money .Amount}}</td></tr>
                    {{ end }}
                    <tr>
                        <th></th>
                        <th class="money">{{money .PreviousIncome.Total}}</th>
                    </tr>
                </table>
            </td>
            <td>
                <table class="list">
                    <tr>
                        <th>{{.PreviousMonth}}</th>
                        <th>Expense</th>
                    </tr>
                    {{ range .PreviousExpense.Records}}
                    <tr><td>{{.AccountName}}</td><td class="money">{{money .Amount}}</td></tr>
                    {{ end }}
                    <tr>
                        <th></th>
                        <th class="money">{{money .PreviousExpense.Total}}</th>
                    </tr>
                </table>
            </td>
        </tr>
        <tr>
            <td valign="top">
                <table class="list">
                    <tr>
                        <th>For Year</th>
                        <th>Income</th>
                    </tr>
                    {{ range .YearIncome.Records}}
                    <tr><td>{{.AccountName}}</td><td class="money">{{money .Amount}}</td></tr>
                    {{ end }}
                    <tr>
                        <th></th>
                        <th class="money">{{money .YearIncome.Total}}</th>
                    </tr>
                </table>
            </td>
            <td>
                <table class="list">
                    <tr>
                        <th>For Year</th>
                        <th>Expense</th>
                    </tr>
                    {{ range .YearExpense.Records}}
                    <tr><td>{{.AccountName}}</td><td class="money">{{money .Amount}}</td></tr>
                    {{ end }}
                    <tr>
                        <th></th>
                        <th class="money">{{money .YearExpense.Total}}</th>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
</div>

{{end}}
