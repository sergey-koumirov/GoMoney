<h3>Transactions</h3>

<a href="/transactions/new">New</a> |
<a href="/transactions/new?type=E">Expense</a> |
<a href="/transactions/new?type=I">Income</a> |

{{range .Templates}}
<a href="/transactions/new?template_id={{.ID}}">{{.Title}}</a> | 
{{end}}

<br/>
<br/>
<div>
    <table id="transactions" class="list">
        {{ range .T}}
            <tr class="{{if eq $.CurrentDate .Date}}current{{end}}">
                <td><a href="/transactions/{{.ID}}">{{.Date}}</a></td>
                <td>{{.AccountFrom.Name}}</td>
                <td class="money {{.AccountFrom.Type}}{{.AccountTo.Type}}">{{money .AmountFrom}}</td>

                <td>{{.AccountTo.Name}}</td>
                <td>{{.Comment}}</td>
                <td><a href="/transactions/delete/{{.ID}}" onclick="return confirm('Are you sure?')">X</a></td>
            </tr>
        {{ end }}
        <tr>
            <td colspan="6">
                {{ range $i, $v := .TotalPages}}
                    {{if eq $i $.Page }}
                        {{$i}}
                    {{else}}
                        <a href="/transactions?page={{$i}}">{{$i}}</a>
                    {{end}}
                {{ end }}
            </td>
        </tr>
    </table>
</div>

<div class="info">
    <table id="rests" class="list">
        <tr>
            <th>Balance</th>
            <th>Rest</th>
        </tr>
        {{ range .Rests.Records}}
            <tr><td>{{.AccountName}}</td><td class="money">{{money .Amount}}</td></tr>
        {{ end }}
        <tr>
            <th></th>
            <th class="money">{{money .Rests.Total}}</th>
        </tr>
    </table>

    <div class="current">
        <table class="list">
            <tr>
                <th>{{.CurrentMonth}}</th>
                <th>Income</th>
            </tr>
            {{ range .CurrentIncome.Records}}
            <tr><td>{{.AccountName}}</td><td class="money">{{money .Amount}}</td></tr>
            {{ end }}
            <tr>
                <th></th>
                <th class="money">{{money .CurrentIncome.Total}}</th>
            </tr>
        </table>
        <table class="list">
            <tr>
                <th>{{.CurrentMonth}}</th>
                <th>Expense</th>
            </tr>
            {{ range .CurrentExpense.Records}}
            <tr><td>{{.AccountName}}</td><td class="money">{{money .Amount}}</td></tr>
            {{ end }}
            <tr>
                <th></th>
                <th class="money">{{money .CurrentExpense.Total}}</th>
            </tr>
        </table>
    </div>

    <div class="current">
        <table class="list">
            <tr>
                <th>{{.PreviousMonth}}</th>
                <th>Income</th>
            </tr>
            {{ range .PreviousIncome.Records}}
            <tr><td>{{.AccountName}}</td><td class="money">{{money .Amount}}</td></tr>
            {{ end }}
            <tr>
                <th></th>
                <th class="money">{{money .PreviousIncome.Total}}</th>
            </tr>
        </table>
        <table class="list">
            <tr>
                <th>{{.PreviousMonth}}</th>
                <th>Expense</th>
            </tr>
            {{ range .PreviousExpense.Records}}
            <tr><td>{{.AccountName}}</td><td class="money">{{money .Amount}}</td></tr>
            {{ end }}
            <tr>
                <th></th>
                <th class="money">{{money .PreviousExpense.Total}}</th>
            </tr>
        </table>
    </div>
</div>